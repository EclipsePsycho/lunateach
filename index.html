<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>LunaTeach Marketplace</title>
  <script src="https://telegram.org/js/telegram-web-app.js"></script>
  <style>
    body { font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif; padding: 20px; margin: 0; background: var(--tg-theme-bg-color); color: var(--tg-theme-text-color); min-height: 100vh; }
    h1 { text-align: center; color: var(--tg-theme-link-color); margin: 30px 0; }
    .card { background: var(--tg-theme-secondary-bg-color); border-radius: 16px; padding: 20px; margin: 16px 0; box-shadow: 0 4px 15px rgba(0,0,0,0.2); overflow: hidden; }
    .photo { width: 100%; height: 220px; object-fit: cover; border-radius: 12px; margin-bottom: 16px; }
    .no-photo { width: 100%; height: 220px; background: #333; opacity: 0.3; border-radius: 12px; display: flex; align-items: center; justify-content: center; font-size: 4em; margin-bottom: 16px; }
    .name { font-size: 1.6em; font-weight: bold; margin-bottom: 8px; }
    .detail { margin: 10px 0; color: var(--tg-theme-hint-color); line-height: 1.5; }
    .bio { font-style: italic; margin: 12px 0; }
    .connect-btn { background: var(--tg-theme-button-color); color: var(--tg-theme-button-text-color); border: none; padding: 16px; width: 100%; border-radius: 12px; font-size: 1.3em; font-weight: bold; margin-top: 16px; cursor: pointer; }
    .user-info { text-align: center; padding: 14px; background: var(--tg-theme-secondary-bg-color); border-radius: 12px; margin: 20px 0; font-size: 1.1em; }
  </style>
</head>
<body>
  <div class="user-info" id="user-info"></div>
  <h1>üîç Find Your Teacher</h1>
  <div id="teachers-list"></div>

  <script>
    Telegram.WebApp.ready();
    Telegram.WebApp.expand();

    const user = Telegram.WebApp.initDataUnsafe.user || {};
    document.getElementById('user-info').innerText = `Welcome, ${user.first_name || 'Student'}! üëã`;

    // === ADD YOUR REAL TEACHERS HERE ===
    const teachers = [
      {
        id: "123456789",  // Teacher's Telegram ID (as string)
        name: "Alex Rivera",
        subjects: ["Speaking", "IELTS"],
        availability: "Evening",
        bio: "Native UK speaker with 8+ years helping students reach Band 7+.",
        photo_url: "https://api.telegram.org/file/bot8370587190:AAHRdRZEljVbt-zQtGIG8QQxOqghVLLgc6I/photos/file_123.jpg"  // or null
      },
      {
        id: "987654321",
        name: "Maria Chen",
        subjects: ["Writing", "Speaking"],
        availability: "Morning & Afternoon",
        bio: "Certified teacher specializing in essay structure and conversation.",
        photo_url: null
      },
      // Add more teachers here
    ];

    const list = document.getElementById('teachers-list');
    if (teachers.length === 0) {
      list.innerHTML = '<div style="text-align:center;padding:60px;color:var(--tg-theme-hint-color);">üòî No teachers available yet.</div>';
    } else {
      teachers.forEach(teacher => {
        const card = document.createElement('div');
        card.className = 'card';

        const photoHtml = teacher.photo_url 
          ? `<img src="${teacher.photo_url}" class="photo" alt="${teacher.name}">`
          : `<div class="no-photo">üë§</div>`;

        card.innerHTML = `
          ${photoHtml}
          <div class="name">üßë‚Äçüè´ ${teacher.name}</div>
          <div class="detail"><strong>Subjects:</strong> ${teacher.subjects.join(', ')}</div>
          <div class="detail"><strong>Available:</strong> ${teacher.availability}</div>
          <div class="detail bio">${teacher.bio}</div>
          <button class="connect-btn" data-tid="${teacher.id}">ü§ù Connect Now</button>
        `;
        list.appendChild(card);
      });

      document.querySelectorAll('.connect-btn').forEach(btn => {
        btn.addEventListener('click', () => {
          const tid = btn.dataset.tid;
          Telegram.WebApp.sendData(JSON.stringify({
            action: "connect",
            teacher_id: tid,
            student_name: user.first_name || "Student"
          }));
          btn.innerText = "‚úÖ Request Sent!";
          btn.disabled = true;
          btn.style.opacity = "0.7";
        });
      });
    }
  </script>
</body>
</html>
